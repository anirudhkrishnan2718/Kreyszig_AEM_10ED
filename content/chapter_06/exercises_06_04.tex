\section{Short Impulses, Dirac's Delta Function, Partial Fractions}
\begin{enumerate}
    \item Modeling a simple damped harmonic oscillation,
          \begin{enumerate}
              \item Keeping $ k $ constant and decreasing $ c $ to zero, and aplying an
                    impulse at $ t = \pi $,
                    \begin{align}
                        y'' + cy' + ky                           & = \delta(t - \pi) \\
                        s^2Y - sy(0) - y'(0) + c[sY - y(0)] + kY & = e^{-\pi s}      \\
                        Y[s^2 + cs + k] - y(0)[s + c] - y'(0)    & = e^{-\pi s}
                    \end{align}
                    For simplicity, let $ y(0) = y'(0) = 0,\ k = 1 $
                    \begin{align}
                        Y                         & = \color{y_p} \frac{e^{-\pi s}}
                        {(s+c/2)^2 + (1 - c^2/4)} &
                        \lambda                   & = \sqrt{1 - c^2/4}              \\
                        y                         & = \color{y_h}
                        \left[ \frac{e^{-c(t - \pi)/2}\ \sin(\lambda t - \lambda \pi)}
                            {\lambda} \right] u(t - \pi)
                    \end{align}
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        a = pi;
                                        l(\c) = sqrt(1 - 0.25*\c^2);
                                        g(\c,\x) = e^(-0.5*\c*\x) *
                                        sin(l(\c)*\x - l(\c)*pi) / l(\c);
                                        f(\c, \x) = g(\c, \x - a) * Hea(\x - a);
                                    }
                            ]
                            \begin{axis}[
                                    title = {Varying $ c $ with $ k = 1 $},
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0.5*pi:4*pi,
                                    PiStyleX,
                                    xtick distance = pi,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 5]},
                                ]
                                \foreach [evaluate=\c as \n using (\c)*100/(2)]
                                \c in {0, 0.5, 1, 1.5, 2}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ]{f(\c, x)};
                                            \noexpand \addlegendentry{$ c = \c $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}

              \item Varying $ k $ with $ c = 0 $, and setting $ y(0) = y'(0) = 0 $,
                    \begin{align}
                        y'' + ky                     & = \delta(t - \pi) \\
                        s^2Y - sy(0) - y'(0) + kY    & = e^{-\pi s}      \\
                        Y[s^2 + k] - y(0)[s] - y'(0) & = e^{-\pi s}
                    \end{align}
                    For simplicity, let $ y(0) = y'(0) = 0,\ k = 1 $
                    \begin{align}
                        Y         & = \color{y_p} \frac{e^{-\pi s}}
                        {s^2 + k} &
                        y         & = \color{y_h}
                        \left[ \frac{\sin(\sqrt{k}t - \sqrt{k}\pi)}
                            {\sqrt{k}} \right] u(t - \pi)
                    \end{align}
                    The frequency of the sinusoidal oscillations varies as
                    $ 2\pi\sqrt{k} $ while the amplitude varies as $ 1/\sqrt{k} $.
                    \par Representative plots are plotted for $ k = 0,1,4,9 $
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        a = pi;
                                        g(\k, \x) = sin(sqrt(\k)*\x) / sqrt(\k);
                                        f(\k, \x) = g(\k, \x - a) * Hea(\x - a);
                                    }
                            ]
                            \begin{axis}[
                                    title = {Varying $ k $ with $ c = 0 $},
                                    legend pos = north west,
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0.5*pi:4*pi,
                                    PiStyleX,
                                    xtick distance = pi,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 4]},
                                ]
                                \foreach [evaluate=\k as \n using (\k)*100/(3)]
                                \k in {0,1,2,3}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ]{f(\k^2, x)};
                                            \noexpand \addlegendentry{$ k = \k^2 $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}

              \item Keeping $ k $ constant and decreasing $ c $ to zero, and aplying an
                    impulse at $ t = \pi $ and another negative impulse at $ t = 3\pi $,
                    \begin{align}
                        y'' + cy' + ky                           &
                        = \delta(t - \pi) - \delta(t - 3\pi)       \\
                        s^2Y - sy(0) - y'(0) + c[sY - y(0)] + kY &
                        = e^{-\pi s} - e^{-3\pi s}                 \\
                        Y[s^2 + cs + k] - y(0)[s + c] - y'(0)    &
                        = e^{-\pi s} - e^{-3\pi s}
                    \end{align}
                    For simplicity, let $ y(0) = y'(0) = 0,\ k = 1 $
                    \begin{align}
                        Y       & = \color{y_p}
                        \frac{e^{-\pi s} - e^{-3\pi s}} {(s+c/2)^2 + (1 - c^2/4)} \\
                        \lambda & = \sqrt{1 - c^2/4}                              \\
                        y       & = \color{y_h}
                        \left[ \frac{e^{-c(t - \pi)/2}\ \sin(\lambda t - \lambda \pi)}
                        {\lambda} \right] u(t - \pi)                              \\
                                & \color{y_h} - \left[ \frac{e^{-c(t - 3\pi)/2}\
                                \sin(\lambda t - 3\lambda \pi)}{\lambda} \right]
                        u(t - 3\pi)
                    \end{align}
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        a = pi; b = 3*pi;
                                        l(\c) = sqrt(1 - 0.25*\c^2);
                                        g(\c,\x) = e^(-0.5*\c*\x) *
                                        sin(l(\c)*\x - l(\c)*pi) / l(\c);
                                        f(\c, \x) = g(\c, \x - a) * Hea(\x - a)
                                        - g(\c, \x - b) * Hea(\x - b);
                                    }
                            ]
                            \begin{axis}[
                                    title = {Varying $ c $ with $ k = 1 $},
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0.5*pi:6*pi,
                                    PiStyleX,
                                    xtick distance = pi,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 5]},
                                ]
                                \foreach [evaluate=\c as \n using (\c)*100/(2)]
                                \c in {0, 0.5, 1, 1.5, 2}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ]{f(\c, x)};
                                            \noexpand \addlegendentry{$ c = \c $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}

              \item Varying $ k $ with $ c = 0 $, and setting $ y(0) = y'(0) = 0 $,
                    \begin{align}
                        y'' + ky                     & = \delta(t - \pi)
                        - \delta(t - 3\pi)                                        \\
                        s^2Y - sy(0) - y'(0) + kY    & = e^{-\pi s} - e^{-3\pi s} \\
                        Y[s^2 + k] - y(0)[s] - y'(0) & = e^{-\pi s} - e^{-3\pi s}
                    \end{align}
                    For simplicity, let $ y(0) = y'(0) = 0,\ k = 1 $
                    \begin{align}
                        Y & = \color{y_p} \frac{e^{-\pi s} - e^{-3\pi s}}
                        {s^2 + k}                                         \\
                        y & = \color{y_h}
                        \left[ \frac{\sin(\sqrt{k}t - \sqrt{k}\pi)}
                            {\sqrt{k}} \right] u(t - \pi)
                        - \left[ \frac{\sin(\sqrt{k}t - 3\sqrt{k}\pi)}
                            {\sqrt{k}} \right] u(t - 3\pi)
                    \end{align}
                    The frequency of the sinusoidal oscillations varies as
                    $ 2\pi\sqrt{k} $ while the amplitude varies as $ 1/\sqrt{k} $.
                    \par Representative plots are plotted for $ k = 0,1,4,9 $
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        a = pi; b = 3*pi;
                                        g(\k, \x) = sin(sqrt(\k)*\x) / sqrt(\k);
                                        f(\k, \x) = g(\k, \x - a) * Hea(\x - a)
                                        - g(\k, \x - b)* Hea(\x - b);
                                    }
                            ]
                            \begin{axis}[
                                    title = {Varying $ k $ with $ c = 0 $},
                                    legend pos = north west,
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0.5*pi:4*pi,
                                    PiStyleX,
                                    xtick distance = pi,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 4]},
                                ]
                                \foreach [evaluate=\k as \n using (\k)*100/(3)]
                                \k in {0,1,2,3}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ]{f(\k^2, x)};
                                            \noexpand \addlegendentry{$ k = \k^2 $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}
                    The very elegant result of the system going back to rest when given
                    a negative impulse at $ t = 3\pi $ is easily observed in the plots.
                    This requires the system to have zero daming and therefore not lose
                    any energy with time.
          \end{enumerate}
    \item From Example 1 in the text,
          \begin{enumerate}
              \item Finding the solution for a general $ k $, with impulse magnitude
                    $ 1/k $,
                    \begin{align}
                        y'' + 3y' + 2y  & = [u(t-1) - t(t - 1 - k)]\frac{1}{k}     \\
                        y(0)            & = 0 \qquad y'(0)  = 0                    \\
                        Y[s^2 + 3s + 2] & = \frac{e^{-s} - e^{-s - ks}}{ks}        \\
                        Y               & = \color{y_p} \frac{e^{-s}
                        - e^{-s-ks}}{ks(s + 1)(s + 2)}                             \\
                        g(t)            & = \frac{1 - 2e^{-t} + e^{-2t}}{2k}       \\
                        y               & = f(t-1)u(t-1) - f(t -1 - k)u(t - 1 - k)
                    \end{align}
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        j(\k, \x) = (1/\k) * (0.5
                                        - e^(-\x+1)+0.5*e^(-2*\x+2)) * Hea(\x - 1)
                                        -  (1/\k) * (0.5 - e^(-\x+1+\k)
                                        + 0.5*e^(-2*\x+2+2*\k)) * Hea(\x - 1 - \k);
                                    }
                            ]
                            \begin{axis}[
                                    legend pos = north east,
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0.5:7,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 5]},
                                ]
                                \foreach [evaluate=\k as \n using (\k + 4)*100/(4)]
                                \k in {-4,...,0}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ] {j(2^\k, x)};
                                            \noexpand \addlegendentry{$ k = 2^{\k} $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}
                    CAS issues with providing a smoothed plot at small values of $ k $.

              \item Let the impulse be applied at $ t = a $,
                    \begin{align}
                        y'' + 3y' + 2y          & = \delta(t-a)              \\
                        y(0)                    & = 1 \qquad y'(0)  = 0      \\
                        Y[s^2 + 3s + 2] - (s+3) & = e^{-as}                  \\
                        Y                       & = \frac{e^{-as} + (s+3)
                        }{(s + 1)(s + 2)}                                    \\
                        Y                       & = \color{y_p}\frac{2}{s+1}
                        - \frac{1}{s+2} + e^{-as} \left[ \frac{1}{s+1}
                        - \frac{1}{s+2} \right]                              \\
                        y(t)                    & = 2e^{-t} - e^{-2t}
                        + [e^{-t + a} - e^{-2t + 2a}]u(t - a)                \\
                        y                       & = \color{y_h}
                        \begin{dcases}
                            2e^{-t} - e^{-2t}                     & t < a \\
                            (2 + e^a)e^{-t} - (1 + e^{2a})e^{-2t} & t > a
                        \end{dcases}
                    \end{align}
                    \begin{figure}[H]
                        \centering
                        \begin{tikzpicture}[declare function = {
                                        j(\k, \x) = 2*e^(-\x) - e^(-2*\x) +
                                        (e^(-\x+\k) - e^(-2*\x + 2*\k)) *
                                        Hea(\x - \k);
                                    }
                            ]
                            \begin{axis}[
                                    legend pos = north east,
                                    grid = both,
                                    width = 12cm,
                                    height = 12cm,
                                    Ani,
                                    % restrict y to domain = -2:1,
                                    domain = 0:10,
                                    colormap/viridis,
                                    cycle list = {[samples of colormap = 6]},
                                ]
                                \foreach [evaluate=\k as \n using (\k)*100/(5)]
                                \k in {0,...,5}
                                    {
                                        \edef\temp{%
                                            \noexpand \addplot+[thick,
                                                samples = 200,
                                            ] {j(\k, x)};
                                            \noexpand \addlegendentry{$ k = \k $};
                                        }\temp
                                    }
                            \end{axis}
                        \end{tikzpicture}
                    \end{figure}
                    For the effect of two equal and opposite impulses one after the other
                    on a system with no damping, see Problem 1 part c, where the system
                    does indeed go back to its initial state after both these impulses
                    have been applied. \par
                    The response does depend on $ a $ as can be seen from the
                    coefficients of the decay terms. \par
                    A linear scaling of the impulse $ b $ would simply scale the output
                    after the impulse by the same factor.
          \end{enumerate}

    \item Solving the IVP,
          \begin{align}
              y'' + 4y                  & = \delta(t - \pi)                    &
              y(0)                      & = 8 \qquad y'(0) = 0                   \\
              s^2Y - sy(0) - y'(0) + 4Y & = e^{-\pi s}                         &
              Y                         & = \color{y_p} \frac{e^{-\pi s} + 8s}
              {s^2 + 4}
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = 8\cos(2t) + [0.5\sin(2t)]u(t - \pi)            \\
              y & = \color{y_h}  \begin{dcases}
                                     8\cos(2t)               & y < \pi \\
                                     8\cos(2t) + 0.5\sin(2t) & t > \pi
                                 \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = pi;
                              g(\x) = 0.5 * sin(2*\x);
                              f(\x) = 8 * cos(2*\x) + g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                          PiStyleX,
                          xtick distance = 0.5*pi,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:3*pi]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:3*pi]
                      {0.5*sin(2*x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,8) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 16y                  & = 4\delta(t - 3\pi)                    &
              y(0)                       & = 2 \qquad y'(0) = 0                     \\
              s^2Y - sy(0) - y'(0) + 16Y & = 4e^{-3\pi s}                         &
              Y                          & = \color{y_p} \frac{4e^{-3\pi s} + 2s}
              {s^2 + 16}
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = 2\cos(4t) + [\sin(4t)]u(t - 3\pi)            \\
              y & = \color{y_h}  \begin{dcases}
                                     2\cos(4t)            & y < 3\pi \\
                                     2\cos(4t) + \sin(4t) & t > 3\pi
                                 \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 3 * pi;
                              g(\x) = sin(4*\x);
                              f(\x) = 2 * cos(4*\x) + g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                          PiStyleX,
                          xtick distance = pi,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 2*pi:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:4*pi]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:4*pi]
                      {sin(4*x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,2) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + y                  & = \delta(t - \pi) - \delta(t - 2\pi) &
              y(0)                     & = 0 \qquad y'(0) = 1                   \\
              s^2Y - sy(0) - y'(0) + Y & = e^{-\pi s} - e^{-2\pi s}           &
              Y                        & = \color{y_p} \frac{e^{-\pi s}
                  - e^{-2\pi s} + 1} {s^2 + 1}
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = \sin(t) - [\sin(t)]u(t - \pi) - [\sin(t)]u(t-2\pi) \\
              y & = \color{y_h}  \begin{dcases}
                                     \sin(t)  & y < \pi           \\
                                     0        & y \in (\pi, 2\pi) \\
                                     -\sin(t) & t > 2\pi
                                 \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = pi; b = 2 * pi;
                              g(\x) = sin(\x);
                              f(\x) = g(\x) + g(\x - a) * Hea(\x - a)
                              - g(\x - b) * Hea(\x - b);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                          PiStyleX,
                          xtick distance = pi,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b - 0.001]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:b - 0.001]
                      {-sin(x)};
                      \addplot[GraphSmooth, y_t, domain = b+0.001:4*pi]{f(x)};
                      \addplot[GraphSmooth, dashed, y_t, domain = b+0.001:4*pi]
                      {-sin(x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ y_2 - y_1$};
                      \addlegendentry{$ y_3$};
                      \addlegendentry{$ y_3 - y_2$};
                      \node[OpenInt] at (axis cs:a,0) {};
                      \node[OpenInt,draw = y_p] at (axis cs:b,0) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}


    \item Solving the IVP,
          \begin{align}
              y'' + 4y' + 5y & = \delta(t - 1)                             \\
              y(0)           & = 0 \qquad y'(0) = 3                        \\
              e^{-s}         & = s^2Y - sy(0) - y'(0)
              + 4(sY - y(0)) + 5Y                                          \\
              Y              & = \frac{e^{-s} + 3}
              {(s+4)(s+1)}                                                 \\
                             & = \color{y_p} \frac{1}{s+1} - \frac{1}{s+4}
              + e^{-s}\left[ \frac{(1/3)}{s+1} - \frac{(1/3)}{s+4} \right]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = e^{-t} - e^{-4t} + \left[ \frac{e^{-t+1} -e^{-4t + 4}}{3}
              \right]u(t - 1)                                                 \\
              y & = \color{y_h}
              \begin{dcases}
                  e^{-t} - e^{-4t}                      & t < 1 \\
                  [1 +e/3]e^{-t} - [1 + e^{4}/3]e^{-4t} & t > 1
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 1; b = 4;
                              g(\x) = e^(-\x) - e^(-4*x);
                              f(\x) = g(x) + g(\x - a) * (1/3) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:b]
                      {e^(1-x)/3 - e^(4-4*x)/3};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,0.35) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              4y'' + 24y' + 37y          & = 17e^{-t} + \delta(t - 0.5)           \\
              y(0)                       & = 1 \qquad y'(0) = 1                   \\
              \frac{17}{s+1} + e^{-0.5s} & = 4[s^2Y - sy(0) - y'(0)] +
              24[sY - y(0)] + 37Y                                                 \\
              Y(4s^2 + 24s  + 37)        & = \frac{17}{s+1} + e^{-0.5s} + 4s + 28 \\
              Y                          & = \color{y_p} \frac{1}{s+1} + \frac{2}
              {(s+3)^2 + 0.25}
              + e^{-0.5s}\left[ \frac{0.25}{(s+3)^2 + 0.25} \right]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = e^{-t} + e^{-3t}4\sin(0.5t)
              + \left[ 0.5e^{-3t + 1.5}\sin(0.5t - 0.25) \right]u(t - 0.5) \\
              y & = \color{y_h}
              \begin{dcases}
                  e^{-t} + e^{-3t}4\sin(0.5t) & t < 0.5 \\
                  e^{-t} + e^{-3t} \Big[ 4\sin(0.5t) + 0.5e^{1.5}\sin(0.5t -0.25)
                  \Big]                       & t > 0.5
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 0.5; b = 2;
                              g(\x) = 0.5*e^(-3*\x)*sin(0.5*\x);
                              f(\x) = e^(-\x) + e^(-3*\x)*sin(0.5*\x)
                              + g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:b]
                      {g(\x - a)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,0.66) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 3y' + 2y              & = 10\sin(t) + 10\delta(t-1)             \\
              y(0)                        & = 1 \qquad y'(0) = -1                   \\
              \frac{10}{s^2+1} + 10e^{-s} & = [s^2Y - sy(0) - y'(0)] +
              3[sY - y(0)] + 2Y                                                     \\
              Y(s^2 + 3s  + 2)            & = \frac{10}{s^2 + 1} + 10e^{-s} + (s+2) \\
              Y                           & = \color{y_p} \frac{6}{s+1} - \frac{2}
              {s+2} + \frac{1-3s}{s^2 + 1}
              + 10e^{-s}\left[ \frac{1}{s+1} - \frac{1}{s+2} \right]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = 6e^{-t} - 2e^{-2t} + \sin(t) - 3\cos(t)
              + 10u(t-1)\Big[ e^{-t+1} - e^{-2t + 2} \Big]  \\
              y & = \color{y_h}
              \begin{dcases}
                  6e^{-t} - 2e^{-2t} + \sin(t) - 3\cos(t)                   & t < 1 \\
                  [6 + 10e]e^{-t} - [2 + 10e^2]e^{-2t} + \sin(t) - 3\cos(t) & t > 1
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 1; b = 8;
                              g(\x) = 10 *(e^(-\x) - e^(-2*\x));
                              f(\x) = 6*e^(-\x) - 2*e^(-2*\x) + sin(\x) - 3*cos(\x)
                              + g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:b]
                      {g(\x - a)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,1.2925) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 4y' + 5y        & = [1 - u(t - 10)]e^t -e^{10}\delta(t-10) \\
              y(0)                  & = 0 \qquad y'(0) = 1                     \\
              \frac{1}{s-1} - e^{10-10s}\left[
              \frac{s}{s-1} \right] & = [s^2Y - sy(0) - y'(0)] +
              4[sY - y(0)] + 5Y                                                \\
              Y(s^2 + 4s  + 5)      & = \frac{s}{s-1}\ [1 - e^{10-10s}]        \\
              Y                     & = \color{y_p} \left[ \frac{0.1}{(s-1)}
                  + \frac{0.7 - 0.1(s + 2)}{(s+2)^2 + 1} \right]
              \ [1 - e^{10-10s}]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = 0.1e^t + 0.1e^{-2t}\Big[ 7\sin(t) - \cos(t)\Big] \\
                & - 0.1\ u(t-10)\Big[ e^{t} + e^{-2t+30}\Big\{
              7\sin(t-10) - \cos(t-10)\} \Big]                       \\
              y & = \color{y_h}
              \begin{dcases}
                  0.1e^t + 0.1e^{-2t}\Big[ 7\sin(t) - \cos(t)\Big] & t < 10 \\
                  0.1 \Big[ 7e^{-2t}\sin(t) - e^{-2t}\cos(t)
                  -7e^{-2t+30}\sin(t-10)                                    \\
                  + e^{-2t+30}\cos(t-10) \Big]                     & t > 10
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 10; b = 14;
                              g(\x) = 0.1*e^(\x) + 0.7*e^(-2*\x)*sin(\x)
                              - 0.1*e^(-2*\x)*cos(\x);
                              f(\x) = g(\x) - e^(10) * g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 4:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b]{f(x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \node[OpenInt] at (axis cs:a,2202) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 5y' + 6y   & = \delta(t - \pi/2) + \cos(t)\ u(t-\pi)         \\
              y(0)             & = 0 \qquad y'(0) = 0                            \\
              \frac{-s}{s^2 + 1}
              + e^{-\pi s/2}   & = [s^2Y - sy(0) - y'(0)] +
              5[sY - y(0)] + 6Y                                                  \\
              Y(s^2 + 5s  + 6) & = \frac{-s\ e^{-\pi s}}{s^2 + 1} + e^{-\pi s/2} \\
              Y                & = \color{y_p} e^{-\pi s}\left[ \frac{-0.1s-0.1}
                  {s^2 + 1} + \frac{0.4}{s+2} - \frac{0.3}{s+3} \right] + e^{-\pi s/2}
              \left[ \frac{1}{s+2} - \frac{1}{s+3} \right]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = u(t - \pi)\Big[0.1\cos(t) + 0.1\sin(t) +0.4e^{-2t + 2\pi}
              - 0.3e^{-3t + 3\pi}\Big]                                        \\
                & + u(t - \pi/2)\Big[ e^{-2t + \pi} - e^{-3t + 1.5\pi} \Big]  \\
              y & = \color{y_h}
              \begin{dcases}
                  0                            & t < \pi/2          \\
                  e^{\pi-2t} - e^{1.5\pi - 3t} & t \in (\pi/2, \pi) \\
                  0.1\cos(t) + 0.1\sin(t) + e^{\pi-2t}
                      [ 1 + 0.4e^{\pi}] - e^{1.5\pi - 3t}
                  [1 + 0.3e^{1.5\pi}]          & t > \pi
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = pi/2; b = pi; c = 3*pi;
                              h(\x) = -0.1*cos(\x) - 0.1*sin(\x) + 0.4*e^(-2*\x)
                              - 0.3*e^(-3*\x);
                              g(\x) = e^(-2*\x) - e^(-3*\x);
                              f(\x) = g(\x - a) * Hea(\x - a)
                              + h(\x - b) * Hea(\x - b);
                          }]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                          PiStyleX, xtick distance = 0.5*pi,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b - 0.001]{f(x)};
                      \addplot[GraphSmooth, y_t, domain = b+0.001:c]
                      {f(x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ y_3$};
                      \node[OpenInt] at (axis cs:a,0) {};
                      \node[OpenInt, draw = y_p] at (axis cs:b,0.03423) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 5y' + 6y   & = u(t - 1) + \delta(t - 2)                  \\
              y(0)             & = 0 \qquad y'(0) = 1                        \\
              \frac{e^{-s}}{s}
              + e^{-2s}        & = [s^2Y - sy(0) - y'(0)] +
              5[sY - y(0)] + 6Y                                              \\
              Y(s^2 + 5s  + 6) & = \frac{e^{-s}}{s} + e^{-2s} + 1            \\
              Y                & = \color{y_p} e^{-s}  \Bigg[\frac{(1/6)}{s}
                  - \frac{(1/2)}{s+2} + \frac{(1/3)}{s+3}\Bigg]  +
              [1 + e^{-2s}] \Bigg[ \frac{1}{s+2} - \frac{1}{s+3} \Bigg]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = e^{-2t} - e^{-3t}
              + u(t - 1)\Bigg[ \frac{1 - 3e^{-2(t-1)} + 2e^{-3(t-1)}}{6} \Bigg] \\
                & + u(t - 2)\Bigg[ e^{-2(t-2)} - e^{-3(t-2)} \Bigg]             \\
              y & = \color{y_h}
              \begin{dcases}
                  e^{-2t} - e^{-3t}                                 & t < 1        \\
                  (1/6) + e^{-2t}[1 - 0.5e^2] - e^{-3t} [1 - e^3/3] & t \in (1, 2) \\
                  (1/6) + e^{-2t}[1 - 0.5e^2 + e^4]
                  - e^{-3t}[1 - e^3/3 + e^6]                        & t > 2
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = 1; b = 2; c = 4;
                              g(\x) = e^(-2*\x) - e^(-3*\x);
                              h(\x) = (1/6) * (1 - 3*e^(-2*\x) + 2*e^(-3*\x));
                              f(\x) = g(\x) + h(\x - a) * Hea(\x - a)
                              + g(\x - b) * Hea(\x - b);
                          }]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                          PiStyleX, xtick distance = 0.5*pi,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b - 0.001]{f(x)};
                      \addplot[GraphSmooth, y_t, domain = b+0.001:c]
                      {f(x)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ y_3$};
                      \node[OpenInt] at (axis cs:a,0.0855) {};
                      \node[OpenInt, draw = y_p] at (axis cs:b,0.1314) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Solving the IVP,
          \begin{align}
              y'' + 2y' + 5y                 & = 25t - 100\delta(t - \pi)        \\
              y(0)                           & = -2 \qquad y'(0) = 5             \\
              \frac{25}{s^2} - 100e^{-\pi s} & = [s^2Y - sy(0) - y'(0)] +
              2[sY - y(0)] + 5Y                                                  \\
              Y(s^2 + 2s  + 5)               & = \frac{25}{s^2} - 2s + 1
              - 100e^{-\pi s}                                                    \\
              Y                              & = \color{y_p} \frac{-2s + 5}{s^2}
              - e^{-\pi s} \left[
                  \frac{100}{(s+1)^2 + 4} \right]
          \end{align}
          Restating the output as in piecewise form,
          \begin{align}
              y & = -2 + 5t - u(t-\pi) \Big[ 50e^{-t + \pi}\sin(2t) \Big] \\
              y & = \color{y_h}
              \begin{dcases}
                  -2 + 5t                         & t < \pi \\
                  -2 + 5t - 50e^{\pi - t}\sin(2t) & t > \pi
              \end{dcases}
          \end{align}
          \begin{figure}[H]
              \centering
              \begin{tikzpicture}[declare function = {
                              a = pi; b = 3*pi;
                              g(\x) = 50*e^(-\x)*sin(2*\x);
                              f(\x) = -2 + 5*\x - g(\x - a) * Hea(\x - a);}]
                  \begin{axis}[
                          legend pos = outer north east,
                          xlabel = {Time $ t $},
                          ylabel = {Output $ y $},
                          Ani,
                          grid = both,
                      ]
                      \addplot[GraphSmooth, y_h, domain = 0:a-0.001]{f(x)};
                      \addplot[GraphSmooth, y_p, domain = a+0.001:b]{f(x)};
                      \addplot[GraphSmooth, dashed, y_p, domain = a+0.001:b]
                      {-g(\x - a)};
                      \addlegendentry{$ y_1$};
                      \addlegendentry{$ y_2$};
                      \addlegendentry{$ \Delta y$};
                      \node[OpenInt] at (axis cs:a,13.708) {};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Heaviside formulas,
          \begin{enumerate}
              \item $ a $ is a simple root. After decomposition into fractions, the other
                    terms are guaranteed not to have $ (s-a) $ in their denominator.
                    \begin{align}
                        \frac{F(s)}{G(s)}      & = \frac{A}{(s-a)}
                        + \text{other terms}                                      \\
                        \frac{(s-a)F(s)}{G(s)} & = A + (s-a) [\text{other terms}] \\
                        \lim_{s \to a}
                        \frac{(s-a)F(s)}{G(s)} & = A + (0) [\text{other terms}]   \\
                                               & = A
                    \end{align}

              \item $ a $ is a root of order $ m $,
                    \begin{align}
                        \frac{F(s)}{G(s)}         & = \frac{A_m}{(s-a)^m}
                        + \frac{A_{m-1}} {(s-a)^{m-1}} + \dots
                        + \frac{A_1}{(s-a)} + \text{other terms}                   \\
                        \frac{(s-a)^m F(s)}{G(s)} & = A_m + (s-a)A_{m-1} + \dots
                        + (s-a)^{m-1}A_1                                           \\
                                                  & + (s-a)^m [\text{other terms}] \\
                        \lim_{s \to a}
                        \frac{(s-a)^m F(s)}{G(s)} & = A_m + 0
                        \ [\text{all other terms}]
                        = A_m
                    \end{align}
                    For the other terms, consider the $ (m-k)$ th derivative,
                    \begin{align}
                        \difoverride{m-k}
                        \diff*[m-k]{\frac{(s-a)^m F(s)}
                        {G(s)}}{s} & = (m-k)!\ A_k
                        + (s-a) [\text{some terms}]                  \\
                                   & + (s-a)^m\ [\text{other terms}]
                    \end{align}
                    Taking the limit $ s \to a$ makes every term except
                    $ (m-k)!\ A_k $ go to zero, which proves the relation.
          \end{enumerate}

    \item \begin{enumerate}
              \item For a piecewise continuous function with period $ p $, and some
                    positive integer $ k $,
                    \begin{align}
                        \Lap\{f(t)\}               & = \int_{0}^{p}
                        e^{-st}f(t)\ \dl t + \int_{p}^{2p} e^{-st}f(t)\ \dl t + \dots \\
                        \text{Substitute }\ t - kp & \to r                            \\
                        \int_{kp}^{(k+1)p} e^{-st}f(t)
                        \ \dl t                    & = \int_{0}^{p}
                        e^{-s(r + kp)} f(r + kp)\ \dl r                               \\
                                                   & = \int_{0}^{p} e^{-kps}
                        \ e^{-sr} f(r)\ \dl r                                         \\
                        \Lap\{f(t)\}               & = \sum_{k = 0}^{\infty}
                        e^{-kps} \int_{0}^{p} e^{-sr}f(r)\ \dl r                      \\
                                                   & = \color{y_p} \frac{1}
                        {1 - e^{-ps}} \int_{0}^{p} e^{-sr}f(r)\ \dl r
                    \end{align}

              \item Using the formula from part a, with $ p = 2\pi / \omega $,
                    \begin{align}
                        f_1(t)         & = \color{y_h} \sin(\omega t)
                        [1 - u(t - \pi / \omega)]                        \\
                        \Lap\{f_1(t)\} & = \frac{\omega}{s^2 + \omega^2}
                        [1 + e^{-\pi s/ \omega}]                         \\
                        \Lap\{f(t)\}   & = \color{y_p} \left( \frac{1}
                        {1 - e^{-2\pi s/ \omega}}\right)\
                        \frac{\omega [1 + e^{-\pi s / \omega}]}{s^2 + \omega^2}
                    \end{align}

              \item Full wave rectifier simply changes $ p $ to $ \pi/\omega $,
                    \begin{align}
                        \Lap\{f(t)\}                & = \left[ \frac{1
                                + e^{-\pi s / \omega}}
                            {1 - e^{- \pi s / \omega}} \right]\
                        \frac{\omega}{s^2 + \omega^2}                             \\
                                                    & = \frac{\omega}
                        {s^2 + \omega^2}
                        \left[ \frac{1 + e^{-2\mu}}
                        {1 - e^{-2\mu}} \right]     &
                        \Bigg(\frac{\pi s}{2\omega} & = \mu\Bigg)                 \\
                                                    & = \color{y_p} \frac{\omega}
                        {s^2 + \omega^2} \coth(\mu)
                    \end{align}

              \item For the saw-tooth wave, whose slope is $ k/p $ and period is $ p $,
                    \begin{align}
                        f(t)           & = \color{y_h} (k/p)t\ [1 - u(t - p)] \\
                        \Lap\{f_1(t)\} & = \frac{(k/p)}{s^2} - e^{-ps}
                        \left[ \frac{(k/p)(1 + ps)}{s^2} \right]              \\
                        \Lap\{f(t)\}   & = \color{y_p}  \frac{(k/p)}{s^2}
                        - \frac{k e^{-ps}}{s(1 - e^{-ps})}
                    \end{align}
          \end{enumerate}

    \item Given that the staircase function $ g(t) $ is the difference of two
          simpler functions,
          \begin{align}
              g(t) & =\color{y_h} (k/p)t - \Big[(k/p)t - (k/p)t\ u(t-p)\Big] \\
              G(s) & = \color{y_p} \frac{ke^{-ps}}{s(1 - e^{-ps})}
          \end{align}
\end{enumerate}