\section{Unconstrained Optimization: Method of Steepest Descent}

\begin{enumerate}
    \item Looking at Example 1,
          \begin{align}
              t^*               & = \frac{x^2 + 9y^2}{2x^2 + 54y^2}     &
              \vec{z}(t)        & = \bmatcol{(1-2t)\ x}{(1-6t)\ y}        \\
              \nabla f(\vec{z}) & = \bmatcol{(2 - 4t)\ x}{(6 - 36t)\ y} &
              \nabla f(\vec{x}) & = \bmatcol{2\ x}{6\ y}
          \end{align}
          In order to prove that the gradients calculated at $ \vec{x} $ and $ \vec{z} $
          are perpendicular, and setting $ t = t^* $
          \begin{align}
              \nabla f(\vec{z}) \dotp \nabla f(\vec{x})
               & = (4 - 8t)\ x^2 + (36 - 216t)\ y^2    \\
               & = 4(x^2 + 9y^2) - 8t(x^2 + 27y^2) = 0
          \end{align}

    \item Using the method of steepest descent,
          \begin{align}
              f(\vec{x}) & = x_1^2 + x_2^2                                     &
              \vec{z}(t) & = \bmatcol{x_1\ (1 - 2t)}{x_2\ (1 - 2t)}              \\
              g(t)       & = f\Big[\vec{z}(t)\Big] = (1-2t)^2\ (x_1^2 + x_2^2) &
              t^*        & = 0.5                                                 \\
              \vec{z}(t) & = \bmatcol{0}{0}
          \end{align}
          The initial guess is that this is a paraboloid with minimum at the origin,
          which happens to be the very first iteration.

    \item Finding the iterative formula,
          \begin{align}
              f(\vec{x})        & = 2(x_1 - 1)^2 + (x_2 + 2)^2 - 6                   \\
              \nabla f(\vec{x}) & = \bmatcol{4x_1 - 4}{2x_2 + 4}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1-4t) + 4t}{x_2(1-2t) - 4t}                  \\
              g(t)              & = 2(x_1 - 1)^2 (1-4t)^2 + (x_2 + 2)^2 (1-2t)^2 + 6 \\
              g'(t)             & = 0 = 4(x_1-1)^2\ (1-4t) + (x_2+2)^2\ (1-2t)       \\
              t^*               & = \frac{4(x_1-1)^2 + (x_2 + 2)^2}
              {16(x_1-1)^2 + 2(x_2+2)^2}
          \end{align}
          \begin{table}[H]
              \centering
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[l,$$]|[dotted]Q[l,$$]},
                  colsep = 1em}
                  $n$ & x_1         & x_2          \\ \hline
                  0   & \num{0}     & \num{0}      \\
                  1   & \num{1.333} & \num{-1.333} \\
                  2   & \num{0.889} & \num{-1.778} \\
                  3   & \num{1.037} & \num{-1.926} \\
                  8   & \num{1}     & \num{-2}     \\
                  \hline
              \end{tblr}
          \end{table}

    \item Finding the iterative formula,
          \begin{align}
              f(\vec{x})        & = (x_1 - 2.5)^2 + 0.5(x_2 - 3)^2 + 14.2           \\
              \nabla f(\vec{x}) & = \bmatcol{2x_1 - 5}{x_2 - 3}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1-2t) + 5t}{x_2(1-t) + 3t}                  \\
              g(t)              & = (x_1 - 2.5)^2 (1-2t)^2 + 0.5(x_2 - 3)^2 (1-t)^2
              + 14.2                                                                \\
              g'(t)             & = 0 = 4(x_1-2.5)^2\ (1-2t) + (x_2 - 3)^2\ (1-t)   \\
              t^*               & = \frac{4(x_1 - 2.5)^2 + (x_2 - 3)^2}
              {8(x_1 - 2.5)^2 + (x_2 - 3)^2}
          \end{align}
          \begin{table}[H]
              \centering
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[l,$$]|[dotted]Q[l,$$]},
                  colsep = 1em}
                  $n$ & x_1       & x_2           \\ \hline
                  0   & \num{3}   & \num{4}       \\
                  1   & \num{2.5} & \num{3.5}     \\
                  2   & \num{2.5} & \num{3.25}    \\
                  3   & \num{2.5} & \num{3.125}   \\
                  4   & \num{2.5} & \num{3.0625}  \\
                  5   & \num{2.5} & \num{3.03125} \\
                  10  & \num{2.5} & \num{3}       \\
                  \hline
              \end{tblr}
          \end{table}

    \item Finding the iterative formula, assuming
          \begin{align}
              f(\vec{x})        & = ax_1 + bx_2                  \\
              \nabla f(\vec{x}) & = \bmatcol{a}{b}, \qquad
              \vec{z}(t) = \bmatcol{x_1 - at}{x_2 - bt}          \\
              g(t)              & = ax_1 + bx_2 - (a^2 + b^2)\ t \\
              g'(t)             & = 0 = -(a^2 + b^2)
          \end{align}
          No extremum, since the function is linear in $ x_1 $ and $ x_2 $.

    \item This is a saddle point at the origin.
          \begin{align}
              f(\vec{x})        & = x_1^2 - x_2^2                          \\
              \nabla f(\vec{x}) & = \bmatcol{2x_1}{-2x_2}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1-2t)}{x_2(1 + 2t)}                \\
              g(t)              & = x_1^2 (1-2t)^2 - x_2^2 (1 + 2t)^2      \\
              g'(t)             & = 0 = x_1^2\ (1-2t) + x_2^2\ (1 + 2t)    \\
              t^*               & = \frac{x_1^2 + x_2^2}{2(x_1^2 - x_2^2)}
          \end{align}
          \begin{table}[H]
              \centering
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[l,$$]|[dotted]Q[l,$$]},
                  colsep = 1em}
                  $n$ & x_1          & x_2          \\ \hline
                  0   & \num{1}      & \num{2}      \\
                  1   & \num{2.667}  & \num{-1.333} \\
                  2   & \num{-1.778} & \num{-3.556} \\
                  3   & \num{-4.741} & \num{2.370}  \\
                  4   & \num{3.160}  & \num{6.321}  \\
                  5   & \num{8.428}  & \num{-4.214} \\
                  \hline
              \end{tblr} \hspace{10em}
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[l,$$]|[dotted]Q[l,$$]},
                  colsep = 1em}
                  $n$ & x_1          & x_2          \\ \hline
                  0   & \num{2}      & \num{1}      \\
                  1   & \num{-1.333} & \num{2.667}  \\
                  2   & \num{-3.556} & \num{-1.778} \\
                  3   & \num{2.370}  & \num{-4.741} \\
                  4   & \num{6.321}  & \num{3.160}  \\
                  5   & \num{-4.214} & \num{8.428}  \\
                  \hline
              \end{tblr}
          \end{table}

          \begin{figure}[H]
              \centering
              \pgfplotstableread[col sep=comma]{./tables/table_22_01_06_a.csv}
              \anitableelsixa
              \begin{tikzpicture}
                  \begin{axis}[axis equal, width = 8cm,
                          title = {$ \vec{X}_0 = \color{y_p}(1,2) $},
                          grid = both,Ani,
                          xmin = -9,xmax = 9,ymin = -9,ymax = 9]
                      \addplot[mark = *, dashed] table[x = 0, y = 1]
                          {\anitableelsixa};
                      \node[GraphNode, fill = y_p,inner sep = 2.5pt]
                      at (axis cs:1,2){};
                  \end{axis}
              \end{tikzpicture}
              \pgfplotstableread[col sep=comma]{./tables/table_22_01_06_b.csv}
              \anitableelsixb
              \begin{tikzpicture}
                  \begin{axis}[axis equal, width = 8cm,
                          title = {$ \vec{X}_0 = \color{y_h}(2,1) $},
                          grid = both,Ani,
                          xmin = -9,xmax = 9,ymin = -9,ymax = 9]
                      \addplot[mark = *, dashed] table[x = 0, y = 1]
                          {\anitableelsixb};
                      \node[GraphNode, fill = y_h,inner sep = 2.5pt]
                      at (axis cs:2,1){};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Using the method of steepest descent
          \begin{align}
              f(\vec{x})        & = x_1^2 + cx_2^2                              \\
              \nabla f(\vec{x}) & = \bmatcol{2\ x_1}{2c\ x_2}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1-2t)}{x_2(1 - 2ct)}                    \\
              g(t)              & = x_1^2 (1-2t)^2 + x_2^2\ c (1 - 2ct)^2       \\
              g'(t)             & = 0 = x_1^2\ (1-2t) + c^2 x_2^2\ (1 - 2ct)    \\
              t^*               & = \frac{x_1^2 + c^2x_2^2}{2x_1^2 + 2c^3x_2^2} \\
              \vec{z}_1         & = \frac{x_1x_2}{2(x_1^2 + c^3x_2^2)}\
              \bmatcol{2c^2(c - 1)\ x_2}{2(1-c)\ x_1} =
              \frac{c-1}{(c+1)}\ \bmatcol{c}{-1}                                \\
              \vec{z}_2         & = \frac{(c-1)^2}{(c+1)^2}
              \ \bmatcol{c}{1}
          \end{align}
          Typo in the textbook. TBC.

    \item Using the method of steepest descent, leads to a zigzag infinite progression,
          \begin{align}
              f(\vec{x})        & = x_1^2 - x_2                \\
              \nabla f(\vec{x}) & = \bmatcol{2x_1}{-1}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1-2t)}{x_2 + t}        \\
              g(t)              & = x_1^2 (1-2t)^2 - x_2 - t   \\
              g'(t)             & = 0 = -4x_1^2\ (1-2t) - 1    \\
              t^*               & = \frac{4x_1^2 + 1}{8x_1^2}
          \end{align}
          \begin{figure}[H]
              \centering
              \pgfplotstableread[col sep=comma]{./tables/table_22_01_08.csv}
              \anitableeleight
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[l,$$]|[dotted]Q[l,$$]},
                  colsep = 1em}
                  $n$ & x_1         & x_2         \\ \hline
                  0   & \num{1}     & \num{1}     \\
                  1   & \num{-0.25} & \num{1.625} \\
                  2   & \num{1}     & \num{4.125} \\
                  3   & \num{-0.25} & \num{4.750} \\
                  4   & \num{1}     & \num{7.250} \\
                  5   & \num{-0.25} & \num{7.875} \\
                  \hline
              \end{tblr}
              \hspace{4em}
              \begin{tikzpicture}[baseline=(current axis.outer east)]
                  \begin{axis}[axis equal, width = 8cm,
                          title = {$ \vec{X}_0 = \color{y_p}(1,1) $},
                          grid = both,Ani,
                          xmin = -9,xmax = 9,ymin = -9,ymax = 9]
                      \addplot[mark = *, dashed] table[x = 0, y = 1]
                          {\anitableeleight};
                      \node[GraphNode, fill = y_p,inner sep = 2.5pt]
                      at (axis cs:1,1){};
                  \end{axis}
              \end{tikzpicture}
          \end{figure}

    \item Finding the iterative formula,
          \begin{align}
              f(\vec{x})        & = 0.1(x_1 - 0.1)^2 + x_2^2 - 0.001      \\
              \nabla f(\vec{x}) & = \bmatcol{0.2x_1 - 0.02}{2x_2}, \qquad
              \vec{z}(t) = \bmatcol{x_1(1 - 0.2t) + 0.02t}{x_2(1 - 2t)}   \\
              g(t)              & = 0.1\ (x_1 - 0.1)^2 (1 - 0.2t)^2
              + x_2^2 (1 - 2t)^2 - 0.001                                  \\
              g'(t)             & = 0 = (x_1 - 0.1)^2\ (1 - 0.2t)
              + 100x_2^2\ (1 - 2t)                                        \\
              t^*               & = \frac{(x_1 - 0.1)^2 + 100x_2^2}
              {0.2(x_1 - 0.1)^2 + 200x_2^2}
          \end{align}
          \begin{table}[H]
              \centering
              \begin{tblr}{
                  colspec =
                  {Q[r]|[dotted]Q[r,$$]|[dotted]Q[r,$$]},
                  colsep = 1em}
                  $n$ & x_1         & x_2          \\ \hline
                  0   & \num{3}     & \num{3}      \\
                  1   & \num{2.708} & \num{-0.025} \\
                  2   & \num{0.301} & \num{0.207}  \\
                  3   & \num{0.280} & \num{-0.002} \\
                  4   & \num{0.114} & \num{0.014}  \\
                  5   & \num{0.112} & \num{0.000}  \\
                  6   & \num{0.101} & \num{0.001}  \\
                  \hline
              \end{tblr}
          \end{table}

    \item Steepest descent
          \begin{enumerate}
              \item Program written in \texttt{numpy}
              \item Using the result from Problem 7,
                    \begin{align}
                        f(\vec{x})        & = x_1^2 + 4x_2^2                      \\
                        \nabla f(\vec{x}) & = \bmatcol{2\ x_1}{8\ x_2}, \qquad
                        \vec{z}(t) = \bmatcol{x_1(1-2t)}{x_2(1 - 8t)}             \\
                        g(t)              & = x_1^2 (1-2t)^2 + 4x_2^2\ (1 - 8t)^2 \\
                        g'(t)             & = 0 = x_1^2\ (1-2t)
                        + 16 x_2^2\ (1 - 8t)                                      \\
                        t^*               & = \frac{x_1^2 + 16x_2^2}{2x_1^2
                            + 128x_2^2}
                    \end{align}
                    Since the function only has a global minimum at the origin, all
                    initial points converge to this minimum, with convergence faster for
                    points along the major axis.

              \item Finding the iterative method,
                    \begin{align}
                        f(\vec{x})        & = x_1^2 + x_2^4                           \\
                        \nabla f(\vec{x}) & = \bmatcol{2\ x_1}{4\ x_2^3}, \qquad
                        \vec{z}(t) = \bmatcol{x_1(1-2t)}{x_2 - 4tx_2^3}               \\
                        g(t)              & = x_1^2 (1-2t)^2 + x_2^4\ (1 - 4tx_2^2)^4 \\
                        g'(t)             & = 0 = x_1^2\ (1-2t)
                        + 16 x_2^2\ (1 - 8t)                                          \\
                        t^*               & = \frac{x_1^2 + 16x_2^2}{2x_1^2
                            + 128x_2^2}
                    \end{align}
                    The only minimum is at the origin.
          \end{enumerate}
\end{enumerate}